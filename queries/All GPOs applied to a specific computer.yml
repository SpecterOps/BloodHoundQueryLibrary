name: All GPOs applied to a specific Computer
guid: 1d75a21e-0d34-40c5-9360-281b60737d87
prebuilt: false
platform: Active Directory
category: Domain Information
description: View all GPOs that are applied to any specific computer. This query identifies GPOs that are applied at both the Domain Level and the OU level, saving time in large Active Directory environments where GPO inheritance is complex. Replace "COMPUTER_NAME" with the target computer name or a substring.
query: |-
  MATCH (gpo:GPO)-[:GPLink]->(Base)-[:Contains*..]->(c:Computer) WHERE toLower(c.name) CONTAINS toLower("COMPUTER_NAME")
  RETURN gpo
revision: 1
resources:
- https://penvasecurity.com.au/
- https://github.com/PenvaSecurity/BloodhoundCypherQueries
acknowledgements: Adnan Ullah Khan, @auk0x01
