name: Kerberos-enabled service accounts without AES encryption support
guid: cb8cf96e-21c9-422b-9439-390a13446ca6
prebuilt: false
platform: Active Directory
category: Active Directory Hygiene
description: 
query: |-
  MATCH (n:Base)
  WHERE n.hasspn = true
  AND ((
    n.supportedencryptiontypes <> ['Not defined']
    AND n.supportedencryptiontypes <> []
    AND NONE(type IN n.supportedencryptiontypes WHERE type CONTAINS 'AES128' OR type CONTAINS 'AES256')
  )
  OR (n.pwdlastset < datetime('2008-02-27T00:00:00').epochseconds // Password Last Set before Windows Server 2008
  AND NOT n.pwdlastset IN [-1.0, 0.0]
  ))
  RETURN n
  LIMIT 100
note: 
revision: 1
resources: 
acknowledgements: Martin Sohn Christensen, @martinsohndk

